<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Career Foundation Assessment Report</title>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Times New Roman', Times, serif;
            background-color: #f5f5f5;
            padding: 0;
            line-height: 1.6;
        }

        @page {
            size: A4;
            margin: 0;
        }

        .report-container {
            background: white;
            width: 210mm;
            margin: 20px auto;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        .cover-page {
            height: 297mm;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            page-break-after: always;
            padding: 60px 40px;
            position: relative;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
            color-adjust: exact !important;
        }

        .cover-page h1 {
            font-size: 44px;
            margin-bottom: 20px;
            font-weight: bold;
            letter-spacing: 3px;
            line-height: 1.3;
        }

        .cover-page .subtitle {
            font-size: 19px;
            margin-bottom: 80px;
            opacity: 0.95;
            font-style: italic;
        }

        .cover-page .student-box {
            background: rgba(255,255,255,0.18);
            padding: 50px 70px;
            border-radius: 12px;
            margin: 60px 0;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255,255,255,0.3);
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
        }

        .cover-page .student-box p {
            font-size: 22px;
            margin: 18px 0;
            letter-spacing: 1px;
        }

        .cover-page .footer {
            position: absolute;
            bottom: 60px;
            font-size: 17px;
        }

        .cover-page .footer .company {
            font-size: 26px;
            font-weight: bold;
            margin-bottom: 12px;
            letter-spacing: 2px;
        }

        .report-page {
            min-height: 297mm;
            padding: 25mm 20mm;
            page-break-after: always;
            position: relative;
            background: white;
            overflow: hidden;
        }

        .report-page:last-child {
            page-break-after: auto;
        }

        .rating-grid,
        .chart-container,
        .analysis-box,
        .info-table,
        .subsection-title {
            page-break-inside: avoid;
        }

        .page-header {
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 3px solid #1e3c72;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .page-header h2 {
            font-size: 20px;
            color: #1e3c72;
            font-weight: bold;
        }

        .page-number {
            font-size: 15px;
            color: #666;
            font-weight: 600;
        }

        .page-footer {
            position: absolute;
            bottom: 15mm;
            left: 20mm;
            right: 20mm;
            padding-top: 12px;
            border-top: 2px solid #ddd;
            text-align: center;
            font-size: 11px;
            color: #666;
        }

        .content-area {
            min-height: calc(297mm - 80mm);
        }

        .section-title {
            font-size: 24px;
            color: #1e3c72;
            margin-bottom: 20px;
            font-weight: bold;
            border-bottom: 4px solid #1e3c72;
            padding-bottom: 10px;
            page-break-after: avoid;
        }

        .subsection-title {
            font-size: 18px;
            color: #2a5298;
            margin: 25px 0 15px 0;
            font-weight: bold;
        }

        .info-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0 30px 0;
        }

        .info-table td {
            padding: 12px;
            border: 1px solid #ddd;
            font-size: 14px;
        }

        .info-table .label {
            width: 35%;
            font-weight: bold;
            background: #f8f9fa;
            color: #1e3c72;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
        }

        .rating-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        .rating-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            border-left: 5px solid #1e3c72;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
        }

        .rating-item .label {
            font-weight: bold;
            color: #333;
            font-size: 14px;
            margin-bottom: 6px;
        }

        .rating-item .value {
            font-size: 15px;
            font-weight: bold;
            padding: 5px 12px;
            border-radius: 3px;
            display: inline-block;
            margin-top: 5px;
        }

        .rating-excellent { 
            background: #d4edda !important; 
            color: #155724 !important;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
        }
        .rating-very-good { 
            background: #cfe2ff !important; 
            color: #084298 !important;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
        }
        .rating-good { 
            background: #d1ecf1 !important; 
            color: #0c5460 !important;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
        }
        .rating-average { 
            background: #fff3cd !important; 
            color: #856404 !important;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
        }
        .rating-needs-improvement { 
            background: #f8d7da !important; 
            color: #721c24 !important;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
        }

        .chart-container {
            background: white;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin: 20px 0;
            height: 300px;
        }

        .chart-container canvas {
            max-height: 270px !important;
        }

        .analysis-box {
            background: #f8f9fa;
            padding: 18px;
            border-radius: 5px;
            margin: 18px 0;
            border-left: 5px solid #2a5298;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
        }

        .analysis-box h4 {
            color: #1e3c72;
            margin-bottom: 12px;
            font-size: 16px;
            font-weight: bold;
        }

        .analysis-box ul {
            margin-left: 20px;
        }

        .analysis-box li {
            margin: 8px 0;
            font-size: 13px;
            line-height: 1.7;
        }

        .analysis-box li strong {
            color: #1e3c72;
        }

        .recommendations-box {
            background: #fff9e6;
            padding: 22px;
            border-radius: 5px;
            margin: 20px 0;
            border-left: 5px solid #ff9800;
            page-break-inside: avoid;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
        }

        .recommendations-box h3 {
            color: #e65100;
            margin-bottom: 15px;
            font-size: 20px;
        }

        .recommendations-box ul {
            margin-left: 20px;
        }

        .recommendations-box li {
            margin: 10px 0;
            line-height: 1.7;
            font-size: 13px;
        }

        .action-buttons {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 12px;
        }

        .btn {
            padding: 14px 28px;
            font-size: 15px;
            font-weight: 600;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: 0.3s;
            box-shadow: 0 3px 8px rgba(0,0,0,0.2);
        }

        .btn-primary {
            background: #1e3c72;
            color: white;
        }

        .btn-primary:hover {
            background: #152a52;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .report-container {
                width: 100%;
                box-shadow: none;
                margin: 0;
            }

            .action-buttons {
                display: none !important;
            }

            .cover-page,
            .report-page {
                page-break-after: always;
                box-shadow: none;
                margin: 0;
            }

            .report-page:last-child {
                page-break-after: auto;
            }

            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                color-adjust: exact !important;
            }

            .cover-page {
                background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%) !important;
            }
        }

        @media screen and (max-width: 768px) {
            .report-container {
                width: 100%;
                margin: 0;
            }

            .rating-grid {
                grid-template-columns: 1fr;
            }

            .cover-page h1 {
                font-size: 32px;
            }

            .action-buttons {
                position: static;
                margin: 20px;
                justify-content: center;
            }

            .report-page {
                padding: 20mm 15mm;
            }
        }

        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-content {
            background: white;
            padding: 40px;
            border-radius: 10px;
            text-align: center;
        }

        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #1e3c72;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>

<div class="loading-overlay" id="loadingOverlay">
    <div class="loading-content">
        <div class="loading-spinner"></div>
        <h3>Generating PDF Report...</h3>
        <p>Please wait, this may take a moment.</p>
    </div>
</div>

<div class="action-buttons">
    <button class="btn btn-primary" onclick="downloadPDF()">
        üìÑ Download PDF
    </button>
    <button class="btn btn-secondary" onclick="window.location.href='select-test.html'">
        ‚Üê Back
    </button>
</div>

<div class="report-container" id="reportContainer">
    <!-- COVER PAGE -->
    <div class="cover-page">
        <h1>CAREER FOUNDATION<br>ASSESSMENT REPORT</h1>
        <div class="subtitle">Comprehensive Analysis of Learning Profile and Academic Aptitude</div>
        
        <div class="student-box">
            <p><strong>Student Name:</strong> <span id="coverName">Loading...</span></p>
            <p><strong>Class:</strong> <span id="coverClass">Loading...</span></p>
            <p><strong>Report Date:</strong> <span id="coverDate">Loading...</span></p>
        </div>

        <div class="footer">
            <div class="company">LAKSHYA CAREERS</div>
            <div>Building Foundations for Successful Futures</div>
        </div>
    </div>

    <!-- PAGE 1: INTEREST VS APTITUDE -->
    <div class="report-page">
        <div class="page-header">
            <h2>Career Stream Analysis</h2>
            <span class="page-number">Page 1</span>
        </div>

        <div class="content-area">
            <table class="info-table">
                <tr>
                    <td class="label">Student Name</td>
                    <td id="studentName">Loading...</td>
                </tr>
                <tr>
                    <td class="label">Class/Stream</td>
                    <td id="studentClass">Loading...</td>
                </tr>
                <tr>
                    <td class="label">Assessment Date</td>
                    <td id="reportDate">Loading...</td>
                </tr>
                <tr>
                    <td class="label">Report Generated By</td>
                    <td>Lakshya Careers Assessment System</td>
                </tr>
            </table>

            <div class="section-title">Interest vs Aptitude Comparison</div>
            
            <div id="interestAptitudeContent">
                <p>Loading career stream analysis...</p>
            </div>
        </div>

        <div class="page-footer">
            Career Foundation Assessment Report | Curated by Lakshya Careers | Confidential Document
        </div>
    </div>

    <!-- PAGE 2: STUDY HABITS -->
    <div class="report-page">
        <div class="page-header">
            <h2>Study Habits Assessment</h2>
            <span class="page-number">Page 2</span>
        </div>

        <div class="content-area">
            <div class="section-title">Study Habits Performance</div>
            
            <div id="studyHabitsContent">
                <p>Loading study habits results...</p>
            </div>
        </div>

        <div class="page-footer">
            Career Foundation Assessment Report | Curated by Lakshya Careers | Confidential Document
        </div>
    </div>

    <!-- PAGE 3: LEARNING STYLE -->
    <div class="report-page">
        <div class="page-header">
            <h2>Learning Style Profile</h2>
            <span class="page-number">Page 3</span>
        </div>

        <div class="content-area">
            <div class="section-title">Learning Style Assessment</div>
            
            <div id="learningStyleContent">
                <p>Loading learning style results...</p>
            </div>
        </div>

        <div class="page-footer">
            Career Foundation Assessment Report | Curated by Lakshya Careers | Confidential Document
        </div>
    </div>

    <!-- PAGE 4: RECOMMENDATIONS -->
    <div class="report-page">
        <div class="page-header">
            <h2>Recommendations & Guidance</h2>
            <span class="page-number">Page 4</span>
        </div>

        <div class="content-area">
            <div class="section-title">Overall Recommendations & Guidance</div>
            
            <div class="recommendations-box">
                <h3>Personalized Career & Academic Recommendations</h3>
                <div id="overallRecommendations">
                    <p>Loading recommendations...</p>
                </div>
            </div>

            <div style="margin-top: 30px; padding: 20px; background: #e3f2fd; border-radius: 5px; border-left: 5px solid #1e3c72; page-break-inside: avoid; -webkit-print-color-adjust: exact; print-color-adjust: exact;">
                <h4 style="color: #1e3c72; margin-bottom: 12px; font-size: 16px; font-weight: bold;">Important Note</h4>
                <p style="line-height: 1.7; font-size: 13px;">
                    This assessment provides a comprehensive snapshot of your current abilities, learning preferences, and study habits. 
                    Remember that abilities can be developed with consistent effort and proper guidance. Your performance today does not 
                    limit your potential tomorrow. Focus on steady improvement, maintain a positive attitude, and seek support when needed. 
                    These foundational years are crucial for building habits and skills that will serve you throughout your academic and 
                    professional journey.
                </p>
            </div>

            <div style="margin-top: 30px; text-align: center; padding: 20px; background: #f8f9fa; border-radius: 5px; -webkit-print-color-adjust: exact; print-color-adjust: exact;">
                <p style="font-size: 13px; color: #0f0202; line-height: 1.7;">
                    <strong style="font-size: 15px; color: #1e3c72;">For Career Counseling and Further Guidance:</strong><br>
                    <b>Contact Lakshya Careers</b>: 9422148945 | lakshyacareer8@gmail.com<br>
                    <em>This report is confidential and intended solely for the use of the student and their guardians.</em>
                </p>
            </div>
        </div>

        <div class="page-footer">
            Career Foundation Assessment Report | Curated by Lakshya Careers | Confidential Document
        </div>
    </div>
</div>

<script>
async function downloadPDF() {
    const { jsPDF } = window.jspdf;
    
    document.getElementById('loadingOverlay').classList.add('active');
    document.querySelector('.action-buttons').style.display = 'none';
    
    try {
        const pdf = new jsPDF('p', 'mm', 'a4');
        const pages = document.querySelectorAll('.cover-page, .report-page');
        
        for (let i = 0; i < pages.length; i++) {
            const page = pages[i];
            
            const canvas = await html2canvas(page, {
                scale: 2,
                useCORS: true,
                logging: false,
                backgroundColor: page.classList.contains('cover-page') ? null : '#ffffff',
                windowWidth: 794,
                windowHeight: 1123
            });
            
            const imgData = canvas.toDataURL('image/png');
            
            if (i > 0) {
                pdf.addPage();
            }
            
            pdf.addImage(imgData, 'PNG', 0, 0, 210, 297);
        }
        
        const studentName = localStorage.getItem("student_name") || "Student";
        const fileName = `Career_Assessment_Report_${studentName.replace(/\s+/g, '_')}.pdf`;
        
        pdf.save(fileName);
        
    } catch (error) {
        console.error('Error generating PDF:', error);
        alert('Error generating PDF. Please try again.');
    } finally {
        document.getElementById('loadingOverlay').classList.remove('active');
        document.querySelector('.action-buttons').style.display = 'flex';
    }
}
</script>

<script src="combined-report.js"></script>

</body>
</html>